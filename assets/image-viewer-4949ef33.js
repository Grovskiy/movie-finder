import{a6 as P,b5 as xe,b6 as ie,b7 as Le,a8 as Ce,b as be,ae as Z,af as we,a as de,k as le,b8 as ge,b9 as Te,ba as ze,aN as he,l as ke,bb as Ne,r as C,bc as Oe,s as $e,c as E,w as fe,a7 as Ie,o as Ee,m as L,t as me,A as p,v as R,q as x,y as w,d as n,H as ve,z as Re,D as A,E as F,bd as Ae,n as B,I as oe,B as Be,F as Me,be as Ve,bf as De,aj as Fe,bg as Pe,bh as Xe,J as Ye,x as He,C as We,G as se,T as je,bi as Ke,_ as Se,am as q,ai as G,bj as qe,P as _e,aM as Ge,bk as Ue,$ as Ze,ap as Je,h as Qe,K as et,bl as tt}from"./index-cfb8094d.js";const nt=(e,s)=>{if(!P||!e||!s)return!1;const t=e.getBoundingClientRect();let u;return s instanceof Element?u=s.getBoundingClientRect():u={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},t.top<u.bottom&&t.bottom>u.top&&t.right>u.left&&t.left<u.right};var at=/\s/;function rt(e){for(var s=e.length;s--&&at.test(e.charAt(s)););return s}var st=/^\s+/;function it(e){return e&&e.slice(0,rt(e)+1).replace(st,"")}var pe=0/0,ot=/^[-+]0x[0-9a-f]+$/i,lt=/^0b[01]+$/i,ut=/^0o[0-7]+$/i,ct=parseInt;function ye(e){if(typeof e=="number")return e;if(xe(e))return pe;if(ie(e)){var s=typeof e.valueOf=="function"?e.valueOf():e;e=ie(s)?s+"":s}if(typeof e!="string")return e===0?e:+e;e=it(e);var t=lt.test(e);return t||ut.test(e)?ct(e.slice(2),t?2:8):ot.test(e)?pe:+e}var dt=function(){return Le.Date.now()};const ue=dt;var ft="Expected a function",mt=Math.max,vt=Math.min;function gt(e,s,t){var u,o,v,O,i,I,y=0,S=!1,_=!1,b=!0;if(typeof e!="function")throw new TypeError(ft);s=ye(s)||0,ie(t)&&(S=!!t.leading,_="maxWait"in t,v=_?mt(ye(t.maxWait)||0,s):v,b="trailing"in t?!!t.trailing:b);function f(c){var h=u,T=o;return u=o=void 0,y=c,O=e.apply(T,h),O}function M(c){return y=c,i=setTimeout(D,s),S?f(c):O}function d(c){var h=c-I,T=c-y,j=s-h;return _?vt(j,v-T):j}function V(c){var h=c-I,T=c-y;return I===void 0||h>=s||h<0||_&&T>=v}function D(){var c=ue();if(V(c))return X(c);i=setTimeout(D,d(c))}function X(c){return i=void 0,b&&u?f(c):(u=o=void 0,O)}function W(){i!==void 0&&clearTimeout(i),y=0,u=I=o=i=void 0}function Y(){return i===void 0?O:X(ue())}function H(){var c=ue(),h=V(c);if(u=arguments,o=this,I=c,h){if(i===void 0)return M(I);if(_)return clearTimeout(i),i=setTimeout(D,s),f(I)}return i===void 0&&(i=setTimeout(D,s)),O}return H.cancel=W,H.flush=Y,H}var pt="Expected a function";function ce(e,s,t){var u=!0,o=!0;if(typeof e!="function")throw new TypeError(pt);return ie(t)&&(u="leading"in t?!!t.leading:u,o="trailing"in t?!!t.trailing:o),gt(e,s,{leading:u,maxWait:s,trailing:o})}const yt=(e,s)=>{if(!P)return!1;const t={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(s)],u=Ce(e,t);return["scroll","auto","overlay"].some(o=>u.includes(o))},bt=(e,s)=>{if(!P)return;let t=e;for(;t;){if([window,document,document.documentElement].includes(t))return window;if(yt(t,s))return t;t=t.parentNode}return t},wt=be({urlList:{type:Z(Array),default:()=>we([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:Z(String)}}),ht={close:()=>!0,switch:e=>de(e),rotate:e=>de(e)},kt=["src","crossorigin"],It=le({name:"ElImageViewer"}),Et=le({...It,props:wt,emits:ht,setup(e,{expose:s,emit:t}){var u;const o=e,v={CONTAIN:{name:"contain",icon:ge(Te)},ORIGINAL:{name:"original",icon:ge(ze)}},{t:O}=he(),i=ke("image-viewer"),{nextZIndex:I}=Ne(),y=C(),S=C([]),_=Oe(),b=C(!0),f=C(o.initialIndex),M=$e(v.CONTAIN),d=C({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),V=C((u=o.zIndex)!=null?u:I()),D=E(()=>{const{urlList:r}=o;return r.length<=1}),X=E(()=>f.value===0),W=E(()=>f.value===o.urlList.length-1),Y=E(()=>o.urlList[f.value]),H=E(()=>[i.e("btn"),i.e("prev"),i.is("disabled",!o.infinite&&X.value)]),c=E(()=>[i.e("btn"),i.e("next"),i.is("disabled",!o.infinite&&W.value)]),h=E(()=>{const{scale:r,deg:l,offsetX:m,offsetY:z,enableTransition:$}=d.value;let k=m/r,N=z/r;switch(l%360){case 90:case-270:[k,N]=[N,-k];break;case 180:case-180:[k,N]=[-k,-N];break;case 270:case-90:[k,N]=[-N,k];break}const K={transform:`scale(${r}) rotate(${l}deg) translate(${k}px, ${N}px)`,transition:$?"transform .3s":""};return M.value.name===v.CONTAIN.name&&(K.maxWidth=K.maxHeight="100%"),K});function T(){J(),t("close")}function j(){const r=ce(m=>{switch(m.code){case q.esc:o.closeOnPressEscape&&T();break;case q.space:ae();break;case q.left:re();break;case q.up:g("zoomIn");break;case q.right:a();break;case q.down:g("zoomOut");break}}),l=ce(m=>{const z=m.deltaY||m.deltaX;g(z<0?"zoomIn":"zoomOut",{zoomRate:o.zoomRate,enableTransition:!1})});_.run(()=>{G(document,"keydown",r),G(document,"wheel",l)})}function J(){_.stop()}function Q(){b.value=!1}function ee(r){b.value=!1,r.target.alt=O("el.image.error")}function te(r){if(b.value||r.button!==0||!y.value)return;d.value.enableTransition=!1;const{offsetX:l,offsetY:m}=d.value,z=r.pageX,$=r.pageY,k=ce(K=>{d.value={...d.value,offsetX:l+K.pageX-z,offsetY:m+K.pageY-$}}),N=G(document,"mousemove",k);G(document,"mouseup",()=>{N()}),r.preventDefault()}function ne(){d.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function ae(){if(b.value)return;const r=qe(v),l=Object.values(v),m=M.value.name,$=(l.findIndex(k=>k.name===m)+1)%r.length;M.value=v[r[$]],ne()}function U(r){const l=o.urlList.length;f.value=(r+l)%l}function re(){X.value&&!o.infinite||U(f.value-1)}function a(){W.value&&!o.infinite||U(f.value+1)}function g(r,l={}){if(b.value)return;const{minScale:m,maxScale:z}=o,{zoomRate:$,rotateDeg:k,enableTransition:N}={zoomRate:o.zoomRate,rotateDeg:90,enableTransition:!0,...l};switch(r){case"zoomOut":d.value.scale>m&&(d.value.scale=Number.parseFloat((d.value.scale/$).toFixed(3)));break;case"zoomIn":d.value.scale<z&&(d.value.scale=Number.parseFloat((d.value.scale*$).toFixed(3)));break;case"clockwise":d.value.deg+=k,t("rotate",d.value.deg);break;case"anticlockwise":d.value.deg-=k,t("rotate",d.value.deg);break}d.value.enableTransition=N}return fe(Y,()=>{Ie(()=>{const r=S.value[0];r!=null&&r.complete||(b.value=!0)})}),fe(f,r=>{ne(),t("switch",r)}),Ee(()=>{var r,l;j(),(l=(r=y.value)==null?void 0:r.focus)==null||l.call(r)}),s({setActiveItem:U}),(r,l)=>(L(),me(Ke,{to:"body",disabled:!r.teleported},[p(je,{name:"viewer-fade",appear:""},{default:R(()=>[x("div",{ref_key:"wrapper",ref:y,tabindex:-1,class:w(n(i).e("wrapper")),style:ve({zIndex:V.value})},[x("div",{class:w(n(i).e("mask")),onClick:l[0]||(l[0]=Re(m=>r.hideOnClickModal&&T(),["self"]))},null,2),A(" CLOSE "),x("span",{class:w([n(i).e("btn"),n(i).e("close")]),onClick:T},[p(n(F),null,{default:R(()=>[p(n(Ae))]),_:1})],2),A(" ARROW "),n(D)?A("v-if",!0):(L(),B(oe,{key:0},[x("span",{class:w(n(H)),onClick:re},[p(n(F),null,{default:R(()=>[p(n(Be))]),_:1})],2),x("span",{class:w(n(c)),onClick:a},[p(n(F),null,{default:R(()=>[p(n(Me))]),_:1})],2)],64)),A(" ACTIONS "),x("div",{class:w([n(i).e("btn"),n(i).e("actions")])},[x("div",{class:w(n(i).e("actions__inner"))},[p(n(F),{onClick:l[1]||(l[1]=m=>g("zoomOut"))},{default:R(()=>[p(n(Ve))]),_:1}),p(n(F),{onClick:l[2]||(l[2]=m=>g("zoomIn"))},{default:R(()=>[p(n(De))]),_:1}),x("i",{class:w(n(i).e("actions__divider"))},null,2),p(n(F),{onClick:ae},{default:R(()=>[(L(),me(Fe(n(M).icon)))]),_:1}),x("i",{class:w(n(i).e("actions__divider"))},null,2),p(n(F),{onClick:l[3]||(l[3]=m=>g("anticlockwise"))},{default:R(()=>[p(n(Pe))]),_:1}),p(n(F),{onClick:l[4]||(l[4]=m=>g("clockwise"))},{default:R(()=>[p(n(Xe))]),_:1})],2)],2),A(" CANVAS "),x("div",{class:w(n(i).e("canvas"))},[(L(!0),B(oe,null,Ye(r.urlList,(m,z)=>He((L(),B("img",{ref_for:!0,ref:$=>S.value[z]=$,key:m,src:m,style:ve(n(h)),class:w(n(i).e("img")),crossorigin:r.crossorigin,onLoad:Q,onError:ee,onMousedown:te},null,46,kt)),[[We,z===f.value]])),128))],2),se(r.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var St=Se(Et,[["__file","image-viewer.vue"]]);const _t=_e(St),xt=be({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:Z([String,Object])},previewSrcList:{type:Z(Array),default:()=>we([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:Z(String)}}),Lt={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>de(e),close:()=>!0,show:()=>!0},Ct=["src","loading","crossorigin"],Tt={key:0},zt=le({name:"ElImage",inheritAttrs:!1}),Nt=le({...zt,props:xt,emits:Lt,setup(e,{emit:s}){const t=e;let u="";const{t:o}=he(),v=ke("image"),O=Ge(),i=Ue(),I=C(),y=C(!1),S=C(!0),_=C(!1),b=C(),f=C(),M=P&&"loading"in HTMLImageElement.prototype;let d,V;const D=E(()=>[v.e("inner"),Y.value&&v.e("preview"),S.value&&v.is("loading")]),X=E(()=>O.style),W=E(()=>{const{fit:a}=t;return P&&a?{objectFit:a}:{}}),Y=E(()=>{const{previewSrcList:a}=t;return Array.isArray(a)&&a.length>0}),H=E(()=>{const{previewSrcList:a,initialIndex:g}=t;let r=g;return g>a.length-1&&(r=0),r}),c=E(()=>t.loading==="eager"?!1:!M&&t.loading==="lazy"||t.lazy),h=()=>{P&&(S.value=!0,y.value=!1,I.value=t.src)};function T(a){S.value=!1,y.value=!1,s("load",a)}function j(a){S.value=!1,y.value=!0,s("error",a)}function J(){nt(b.value,f.value)&&(h(),te())}const Q=tt(J,200,!0);async function ee(){var a;if(!P)return;await Ie();const{scrollContainer:g}=t;Je(g)?f.value=g:Qe(g)&&g!==""?f.value=(a=document.querySelector(g))!=null?a:void 0:b.value&&(f.value=bt(b.value)),f.value&&(d=G(f,"scroll",Q),setTimeout(()=>J(),100))}function te(){!P||!f.value||!Q||(d==null||d(),f.value=void 0)}function ne(a){if(a.ctrlKey){if(a.deltaY<0)return a.preventDefault(),!1;if(a.deltaY>0)return a.preventDefault(),!1}}function ae(){Y.value&&(V=G("wheel",ne,{passive:!1}),u=document.body.style.overflow,document.body.style.overflow="hidden",_.value=!0,s("show"))}function U(){V==null||V(),document.body.style.overflow=u,_.value=!1,s("close")}function re(a){s("switch",a)}return fe(()=>t.src,()=>{c.value?(S.value=!0,y.value=!1,te(),ee()):h()}),Ee(()=>{c.value?ee():h()}),(a,g)=>(L(),B("div",{ref_key:"container",ref:b,class:w([n(v).b(),a.$attrs.class]),style:ve(n(X))},[y.value?se(a.$slots,"error",{key:0},()=>[x("div",{class:w(n(v).e("error"))},et(n(o)("el.image.error")),3)]):(L(),B(oe,{key:1},[I.value!==void 0?(L(),B("img",Ze({key:0},n(i),{src:I.value,loading:a.loading,style:n(W),class:n(D),crossorigin:a.crossorigin,onClick:ae,onLoad:T,onError:j}),null,16,Ct)):A("v-if",!0),S.value?(L(),B("div",{key:1,class:w(n(v).e("wrapper"))},[se(a.$slots,"placeholder",{},()=>[x("div",{class:w(n(v).e("placeholder"))},null,2)])],2)):A("v-if",!0)],64)),n(Y)?(L(),B(oe,{key:2},[_.value?(L(),me(n(_t),{key:0,"z-index":a.zIndex,"initial-index":n(H),infinite:a.infinite,"zoom-rate":a.zoomRate,"min-scale":a.minScale,"max-scale":a.maxScale,"url-list":a.previewSrcList,"hide-on-click-modal":a.hideOnClickModal,teleported:a.previewTeleported,"close-on-press-escape":a.closeOnPressEscape,onClose:U,onSwitch:re},{default:R(()=>[a.$slots.viewer?(L(),B("div",Tt,[se(a.$slots,"viewer")])):A("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):A("v-if",!0)],64)):A("v-if",!0)],6))}});var Ot=Se(Nt,[["__file","image.vue"]]);const Rt=_e(Ot);export{Rt as E,gt as d,ce as t};
